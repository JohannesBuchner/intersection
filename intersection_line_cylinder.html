<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <title>line - cylinder intersection -- Intersection formulas for 3d objects</title>
  </head>
  <body>
<h2>line - cylinder intersection</h2>
<h4>Equation for line (cartesian)</h4>
<ul>
<li>x: <img src="eq239.png" alt="t + x_{0}" /></li>
<li>y: <img src="eq240.png" alt="k t + y_{0}" /></li>
<li>z: <img src="eq241.png" alt="l t + z_{0}" /></li>
</ul>
<h4>Equation for cylinder (cartesian)</h4>
<p>Assumed to be centred at 0, the coordinate system origin.</p>
0=<img src="eq242.png" alt="-1 + \frac{y^{2}}{b^{2}} + \frac{x^{2}}{a^{2}}" />
<h4>Intersection solutions</h4>
<p>Parametric solution (t). Solutions were derived automatically using sympy.</p>
<ul><li><img src="eq243.png" alt="\frac{1}{a^{2} k^{2} + b^{2}} \left(- a^{2} k y_{0} - b^{2} x_{0} + \sqrt{a^{2} b^{2} \left(a^{2} k^{2} + b^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}\right)}\right)" /></li>
<li><img src="eq244.png" alt="- \frac{1}{a^{2} k^{2} + b^{2}} \left(a^{2} k y_{0} + b^{2} x_{0} + \sqrt{a^{2} b^{2} \left(a^{2} k^{2} + b^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}\right)}\right)" /></li>
</ul><p>Points in cartesian coordinates (x, y, z)</p>
<ul><li><ul><li>x: <img src="eq245.png" alt="x_{0} + \frac{1}{a^{2} k^{2} + b^{2}} \left(- a^{2} k y_{0} - b^{2} x_{0} + \sqrt{a^{2} b^{2} \left(a^{2} k^{2} + b^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}\right)}\right)" /></li>
<li>y: <img src="eq246.png" alt="\frac{k}{a^{2} k^{2} + b^{2}} \left(- a^{2} k y_{0} - b^{2} x_{0} + \sqrt{a^{2} b^{2} \left(a^{2} k^{2} + b^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}\right)}\right) + y_{0}" /></li>
<li>z: <img src="eq247.png" alt="\frac{l}{a^{2} k^{2} + b^{2}} \left(- a^{2} k y_{0} - b^{2} x_{0} + \sqrt{a^{2} b^{2} \left(a^{2} k^{2} + b^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}\right)}\right) + z_{0}" /></li>
</ul></li><li><ul><li>x: <img src="eq248.png" alt="x_{0} - \frac{1}{a^{2} k^{2} + b^{2}} \left(a^{2} k y_{0} + b^{2} x_{0} + \sqrt{a^{2} b^{2} \left(a^{2} k^{2} + b^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}\right)}\right)" /></li>
<li>y: <img src="eq249.png" alt="- \frac{k}{a^{2} k^{2} + b^{2}} \left(a^{2} k y_{0} + b^{2} x_{0} + \sqrt{a^{2} b^{2} \left(a^{2} k^{2} + b^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}\right)}\right) + y_{0}" /></li>
<li>z: <img src="eq250.png" alt="- \frac{l}{a^{2} k^{2} + b^{2}} \left(a^{2} k y_{0} + b^{2} x_{0} + \sqrt{a^{2} b^{2} \left(a^{2} k^{2} + b^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}\right)}\right) + z_{0}" /></li>
</ul></li></ul><h5>C Code</h5>
<pre>x = x0 + (-pow(a, 2)*k*y0 - pow(b, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(k, 2) + pow(b, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2))))/(pow(a, 2)*pow(k, 2) + pow(b, 2));</pre>
<pre>y = k*(-pow(a, 2)*k*y0 - pow(b, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(k, 2) + pow(b, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2))))/(pow(a, 2)*pow(k, 2) + pow(b, 2)) + y0;</pre>
<pre>z = l*(-pow(a, 2)*k*y0 - pow(b, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(k, 2) + pow(b, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2))))/(pow(a, 2)*pow(k, 2) + pow(b, 2)) + z0;</pre>
<pre>x = x0 - (pow(a, 2)*k*y0 + pow(b, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(k, 2) + pow(b, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2))))/(pow(a, 2)*pow(k, 2) + pow(b, 2));</pre>
<pre>y = -k*(pow(a, 2)*k*y0 + pow(b, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(k, 2) + pow(b, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2))))/(pow(a, 2)*pow(k, 2) + pow(b, 2)) + y0;</pre>
<pre>z = -l*(pow(a, 2)*k*y0 + pow(b, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(k, 2) + pow(b, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2))))/(pow(a, 2)*pow(k, 2) + pow(b, 2)) + z0;</pre>
<h4>Distance inside</h4>
<p>Distance between crossing points.</p>
<img src="eq251.png" alt="2 \left\lvert{\frac{1}{a^{2} k^{2} + b^{2}} \sqrt{a^{2} b^{2} \left(a^{2} k^{2} + b^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}\right)}}\right\rvert" />
<h4>C Code</h4>
<pre>sol1 = (-pow(a, 2)*k*y0 - pow(b, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(k, 2) + pow(b, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2))))/(pow(a, 2)*pow(k, 2) + pow(b, 2));</pre><pre>sol2 = -(pow(a, 2)*k*y0 + pow(b, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(k, 2) + pow(b, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2))))/(pow(a, 2)*pow(k, 2) + pow(b, 2));</pre><pre>distance = 2*fabs(sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(k, 2) + pow(b, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2)))/(pow(a, 2)*pow(k, 2) + pow(b, 2)));</pre><hr/>
<h4>Equation for line (spherical)</h4>
<ul>
<li>x: <img src="eq252.png" alt="t \sin{\left (\theta \right )} \cos{\left (\phi \right )} + x_{0}" /></li>
<li>y: <img src="eq253.png" alt="t \sin{\left (\phi \right )} \sin{\left (\theta \right )} + y_{0}" /></li>
<li>z: <img src="eq254.png" alt="t \cos{\left (\theta \right )} + z_{0}" /></li>
</ul>
<h4>Equation for cylinder (cartesian)</h4>
<p>Assumed to be centred at 0, the coordinate system origin.</p>
0=<img src="eq255.png" alt="-1 + \frac{y^{2}}{b^{2}} + \frac{x^{2}}{a^{2}}" />
<h4>Intersection solutions</h4>
<p>Parametric solution (t). Solutions were derived automatically using sympy.</p>
<ul><li><img src="eq256.png" alt="\frac{1}{\left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} \left(\sqrt{a^{2} b^{2} \left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} + x_{0} y_{0} \sin{\left (2 \phi \right )} - y_{0}^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} - \left(a^{2} y_{0} \sin{\left (\phi \right )} + b^{2} x_{0} \cos{\left (\phi \right )}\right) \sin{\left (\theta \right )}\right)" /></li>
<li><img src="eq257.png" alt="- \frac{1}{\left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} \left(\sqrt{a^{2} b^{2} \left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} + x_{0} y_{0} \sin{\left (2 \phi \right )} - y_{0}^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} + \left(a^{2} y_{0} \sin{\left (\phi \right )} + b^{2} x_{0} \cos{\left (\phi \right )}\right) \sin{\left (\theta \right )}\right)" /></li>
</ul><p>Points in cartesian coordinates (x, y, z)</p>
<ul><li><ul><li>x: <img src="eq258.png" alt="x_{0} + \frac{\cos{\left (\phi \right )}}{\left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )}\right) \sin{\left (\theta \right )}} \left(\sqrt{a^{2} b^{2} \left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} + x_{0} y_{0} \sin{\left (2 \phi \right )} - y_{0}^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} - \left(a^{2} y_{0} \sin{\left (\phi \right )} + b^{2} x_{0} \cos{\left (\phi \right )}\right) \sin{\left (\theta \right )}\right)" /></li>
<li>y: <img src="eq259.png" alt="y_{0} + \frac{\sin{\left (\phi \right )}}{\left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )}\right) \sin{\left (\theta \right )}} \left(\sqrt{a^{2} b^{2} \left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} + x_{0} y_{0} \sin{\left (2 \phi \right )} - y_{0}^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} - \left(a^{2} y_{0} \sin{\left (\phi \right )} + b^{2} x_{0} \cos{\left (\phi \right )}\right) \sin{\left (\theta \right )}\right)" /></li>
<li>z: <img src="eq260.png" alt="z_{0} + \frac{\cos{\left (\theta \right )}}{\left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} \left(\sqrt{a^{2} b^{2} \left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} + x_{0} y_{0} \sin{\left (2 \phi \right )} - y_{0}^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} - \left(a^{2} y_{0} \sin{\left (\phi \right )} + b^{2} x_{0} \cos{\left (\phi \right )}\right) \sin{\left (\theta \right )}\right)" /></li>
</ul></li><li><ul><li>x: <img src="eq261.png" alt="x_{0} - \frac{\cos{\left (\phi \right )}}{\left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )}\right) \sin{\left (\theta \right )}} \left(\sqrt{a^{2} b^{2} \left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} + x_{0} y_{0} \sin{\left (2 \phi \right )} - y_{0}^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} + \left(a^{2} y_{0} \sin{\left (\phi \right )} + b^{2} x_{0} \cos{\left (\phi \right )}\right) \sin{\left (\theta \right )}\right)" /></li>
<li>y: <img src="eq262.png" alt="y_{0} - \frac{\sin{\left (\phi \right )}}{\left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )}\right) \sin{\left (\theta \right )}} \left(\sqrt{a^{2} b^{2} \left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} + x_{0} y_{0} \sin{\left (2 \phi \right )} - y_{0}^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} + \left(a^{2} y_{0} \sin{\left (\phi \right )} + b^{2} x_{0} \cos{\left (\phi \right )}\right) \sin{\left (\theta \right )}\right)" /></li>
<li>z: <img src="eq263.png" alt="z_{0} - \frac{\cos{\left (\theta \right )}}{\left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} \left(\sqrt{a^{2} b^{2} \left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} + x_{0} y_{0} \sin{\left (2 \phi \right )} - y_{0}^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} + \left(a^{2} y_{0} \sin{\left (\phi \right )} + b^{2} x_{0} \cos{\left (\phi \right )}\right) \sin{\left (\theta \right )}\right)" /></li>
</ul></li></ul><h5>C Code</h5>
<pre>x = x0 + (sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2) - pow(x0, 2)*pow(sin(phi), 2) + x0*y0*sin(2*phi) - pow(y0, 2)*pow(cos(phi), 2))*pow(sin(theta), 2)) - (pow(a, 2)*y0*sin(phi) + pow(b, 2)*x0*cos(phi))*sin(theta))*cos(phi)/((pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2))*sin(theta));</pre>
<pre>y = y0 + (sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2) - pow(x0, 2)*pow(sin(phi), 2) + x0*y0*sin(2*phi) - pow(y0, 2)*pow(cos(phi), 2))*pow(sin(theta), 2)) - (pow(a, 2)*y0*sin(phi) + pow(b, 2)*x0*cos(phi))*sin(theta))*sin(phi)/((pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2))*sin(theta));</pre>
<pre>z = z0 + (sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2) - pow(x0, 2)*pow(sin(phi), 2) + x0*y0*sin(2*phi) - pow(y0, 2)*pow(cos(phi), 2))*pow(sin(theta), 2)) - (pow(a, 2)*y0*sin(phi) + pow(b, 2)*x0*cos(phi))*sin(theta))*cos(theta)/((pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2))*pow(sin(theta), 2));</pre>
<pre>x = x0 - (sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2) - pow(x0, 2)*pow(sin(phi), 2) + x0*y0*sin(2*phi) - pow(y0, 2)*pow(cos(phi), 2))*pow(sin(theta), 2)) + (pow(a, 2)*y0*sin(phi) + pow(b, 2)*x0*cos(phi))*sin(theta))*cos(phi)/((pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2))*sin(theta));</pre>
<pre>y = y0 - (sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2) - pow(x0, 2)*pow(sin(phi), 2) + x0*y0*sin(2*phi) - pow(y0, 2)*pow(cos(phi), 2))*pow(sin(theta), 2)) + (pow(a, 2)*y0*sin(phi) + pow(b, 2)*x0*cos(phi))*sin(theta))*sin(phi)/((pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2))*sin(theta));</pre>
<pre>z = z0 - (sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2) - pow(x0, 2)*pow(sin(phi), 2) + x0*y0*sin(2*phi) - pow(y0, 2)*pow(cos(phi), 2))*pow(sin(theta), 2)) + (pow(a, 2)*y0*sin(phi) + pow(b, 2)*x0*cos(phi))*sin(theta))*cos(theta)/((pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2))*pow(sin(theta), 2));</pre>
<h4>Distance inside</h4>
<p>Distance between crossing points.</p>
<img src="eq264.png" alt="2 \left\lvert{\frac{1}{\left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} \sqrt{a^{2} b^{2} \left(a^{2} \sin^{2}{\left (\phi \right )} + b^{2} \cos^{2}{\left (\phi \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} + x_{0} y_{0} \sin{\left (2 \phi \right )} - y_{0}^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}}}\right\rvert" />
<h4>C Code</h4>
<pre>sol1 = (sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2) - pow(x0, 2)*pow(sin(phi), 2) + x0*y0*sin(2*phi) - pow(y0, 2)*pow(cos(phi), 2))*pow(sin(theta), 2)) - (pow(a, 2)*y0*sin(phi) + pow(b, 2)*x0*cos(phi))*sin(theta))/((pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2))*pow(sin(theta), 2));</pre><pre>sol2 = -(sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2) - pow(x0, 2)*pow(sin(phi), 2) + x0*y0*sin(2*phi) - pow(y0, 2)*pow(cos(phi), 2))*pow(sin(theta), 2)) + (pow(a, 2)*y0*sin(phi) + pow(b, 2)*x0*cos(phi))*sin(theta))/((pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2))*pow(sin(theta), 2));</pre><pre>distance = 2*fabs(sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2) - pow(x0, 2)*pow(sin(phi), 2) + x0*y0*sin(2*phi) - pow(y0, 2)*pow(cos(phi), 2))*pow(sin(theta), 2))/((pow(a, 2)*pow(sin(phi), 2) + pow(b, 2)*pow(cos(phi), 2))*pow(sin(theta), 2)));</pre><hr/>
