<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <title>line - ellipsoid intersection -- Intersection formulas for 3d objects</title>
  </head>
  <body>
<h2>line - ellipsoid intersection</h2>
<h4>Equation for line (cartesian)</h4>
<ul>
<li>x: <img src="eq187.png" alt="t + x_{0}" /></li>
<li>y: <img src="eq188.png" alt="k t + y_{0}" /></li>
<li>z: <img src="eq189.png" alt="l t + z_{0}" /></li>
</ul>
<h4>Equation for ellipsoid (cartesian)</h4>
<p>Assumed to be centred at 0, the coordinate system origin.</p>
0=<img src="eq190.png" alt="-1 + \frac{z^{2}}{c^{2}} + \frac{y^{2}}{b^{2}} + \frac{x^{2}}{a^{2}}" />
<h4>Intersection solutions</h4>
<p>Parametric solution (t). Solutions were derived automatically using sympy.</p>
<ul><li><img src="eq191.png" alt="\frac{1}{a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} + b^{2} c^{2}} \left(- a^{2} b^{2} l z_{0} - a^{2} c^{2} k y_{0} - b^{2} c^{2} x_{0} + \sqrt{a^{2} b^{2} c^{2} \left(a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} - a^{2} k^{2} z_{0}^{2} + 2 a^{2} k l y_{0} z_{0} - a^{2} l^{2} y_{0}^{2} + b^{2} c^{2} - b^{2} l^{2} x_{0}^{2} + 2 b^{2} l x_{0} z_{0} - b^{2} z_{0}^{2} - c^{2} k^{2} x_{0}^{2} + 2 c^{2} k x_{0} y_{0} - c^{2} y_{0}^{2}\right)}\right)" /></li>
<li><img src="eq192.png" alt="- \frac{1}{a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} + b^{2} c^{2}} \left(a^{2} b^{2} l z_{0} + a^{2} c^{2} k y_{0} + b^{2} c^{2} x_{0} + \sqrt{a^{2} b^{2} c^{2} \left(a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} - a^{2} k^{2} z_{0}^{2} + 2 a^{2} k l y_{0} z_{0} - a^{2} l^{2} y_{0}^{2} + b^{2} c^{2} - b^{2} l^{2} x_{0}^{2} + 2 b^{2} l x_{0} z_{0} - b^{2} z_{0}^{2} - c^{2} k^{2} x_{0}^{2} + 2 c^{2} k x_{0} y_{0} - c^{2} y_{0}^{2}\right)}\right)" /></li>
</ul><p>Points in cartesian coordinates (x, y, z)</p>
<ul><li><ul><li>x: <img src="eq193.png" alt="x_{0} + \frac{1}{a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} + b^{2} c^{2}} \left(- a^{2} b^{2} l z_{0} - a^{2} c^{2} k y_{0} - b^{2} c^{2} x_{0} + \sqrt{a^{2} b^{2} c^{2} \left(a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} - a^{2} k^{2} z_{0}^{2} + 2 a^{2} k l y_{0} z_{0} - a^{2} l^{2} y_{0}^{2} + b^{2} c^{2} - b^{2} l^{2} x_{0}^{2} + 2 b^{2} l x_{0} z_{0} - b^{2} z_{0}^{2} - c^{2} k^{2} x_{0}^{2} + 2 c^{2} k x_{0} y_{0} - c^{2} y_{0}^{2}\right)}\right)" /></li>
<li>y: <img src="eq194.png" alt="\frac{k}{a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} + b^{2} c^{2}} \left(- a^{2} b^{2} l z_{0} - a^{2} c^{2} k y_{0} - b^{2} c^{2} x_{0} + \sqrt{a^{2} b^{2} c^{2} \left(a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} - a^{2} k^{2} z_{0}^{2} + 2 a^{2} k l y_{0} z_{0} - a^{2} l^{2} y_{0}^{2} + b^{2} c^{2} - b^{2} l^{2} x_{0}^{2} + 2 b^{2} l x_{0} z_{0} - b^{2} z_{0}^{2} - c^{2} k^{2} x_{0}^{2} + 2 c^{2} k x_{0} y_{0} - c^{2} y_{0}^{2}\right)}\right) + y_{0}" /></li>
<li>z: <img src="eq195.png" alt="\frac{l}{a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} + b^{2} c^{2}} \left(- a^{2} b^{2} l z_{0} - a^{2} c^{2} k y_{0} - b^{2} c^{2} x_{0} + \sqrt{a^{2} b^{2} c^{2} \left(a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} - a^{2} k^{2} z_{0}^{2} + 2 a^{2} k l y_{0} z_{0} - a^{2} l^{2} y_{0}^{2} + b^{2} c^{2} - b^{2} l^{2} x_{0}^{2} + 2 b^{2} l x_{0} z_{0} - b^{2} z_{0}^{2} - c^{2} k^{2} x_{0}^{2} + 2 c^{2} k x_{0} y_{0} - c^{2} y_{0}^{2}\right)}\right) + z_{0}" /></li>
</ul></li><li><ul><li>x: <img src="eq196.png" alt="x_{0} - \frac{1}{a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} + b^{2} c^{2}} \left(a^{2} b^{2} l z_{0} + a^{2} c^{2} k y_{0} + b^{2} c^{2} x_{0} + \sqrt{a^{2} b^{2} c^{2} \left(a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} - a^{2} k^{2} z_{0}^{2} + 2 a^{2} k l y_{0} z_{0} - a^{2} l^{2} y_{0}^{2} + b^{2} c^{2} - b^{2} l^{2} x_{0}^{2} + 2 b^{2} l x_{0} z_{0} - b^{2} z_{0}^{2} - c^{2} k^{2} x_{0}^{2} + 2 c^{2} k x_{0} y_{0} - c^{2} y_{0}^{2}\right)}\right)" /></li>
<li>y: <img src="eq197.png" alt="- \frac{k}{a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} + b^{2} c^{2}} \left(a^{2} b^{2} l z_{0} + a^{2} c^{2} k y_{0} + b^{2} c^{2} x_{0} + \sqrt{a^{2} b^{2} c^{2} \left(a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} - a^{2} k^{2} z_{0}^{2} + 2 a^{2} k l y_{0} z_{0} - a^{2} l^{2} y_{0}^{2} + b^{2} c^{2} - b^{2} l^{2} x_{0}^{2} + 2 b^{2} l x_{0} z_{0} - b^{2} z_{0}^{2} - c^{2} k^{2} x_{0}^{2} + 2 c^{2} k x_{0} y_{0} - c^{2} y_{0}^{2}\right)}\right) + y_{0}" /></li>
<li>z: <img src="eq198.png" alt="- \frac{l}{a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} + b^{2} c^{2}} \left(a^{2} b^{2} l z_{0} + a^{2} c^{2} k y_{0} + b^{2} c^{2} x_{0} + \sqrt{a^{2} b^{2} c^{2} \left(a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} - a^{2} k^{2} z_{0}^{2} + 2 a^{2} k l y_{0} z_{0} - a^{2} l^{2} y_{0}^{2} + b^{2} c^{2} - b^{2} l^{2} x_{0}^{2} + 2 b^{2} l x_{0} z_{0} - b^{2} z_{0}^{2} - c^{2} k^{2} x_{0}^{2} + 2 c^{2} k x_{0} y_{0} - c^{2} y_{0}^{2}\right)}\right) + z_{0}" /></li>
</ul></li></ul><h5>C Code</h5>
<pre>x = x0 + (-pow(a, 2)*pow(b, 2)*l*z0 - pow(a, 2)*pow(c, 2)*k*y0 - pow(b, 2)*pow(c, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*pow(c, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) - pow(a, 2)*pow(k, 2)*pow(z0, 2) + 2*pow(a, 2)*k*l*y0*z0 - pow(a, 2)*pow(l, 2)*pow(y0, 2) + pow(b, 2)*pow(c, 2) - pow(b, 2)*pow(l, 2)*pow(x0, 2) + 2*pow(b, 2)*l*x0*z0 - pow(b, 2)*pow(z0, 2) - pow(c, 2)*pow(k, 2)*pow(x0, 2) + 2*pow(c, 2)*k*x0*y0 - pow(c, 2)*pow(y0, 2))))/(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) + pow(b, 2)*pow(c, 2));</pre>
<pre>y = k*(-pow(a, 2)*pow(b, 2)*l*z0 - pow(a, 2)*pow(c, 2)*k*y0 - pow(b, 2)*pow(c, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*pow(c, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) - pow(a, 2)*pow(k, 2)*pow(z0, 2) + 2*pow(a, 2)*k*l*y0*z0 - pow(a, 2)*pow(l, 2)*pow(y0, 2) + pow(b, 2)*pow(c, 2) - pow(b, 2)*pow(l, 2)*pow(x0, 2) + 2*pow(b, 2)*l*x0*z0 - pow(b, 2)*pow(z0, 2) - pow(c, 2)*pow(k, 2)*pow(x0, 2) + 2*pow(c, 2)*k*x0*y0 - pow(c, 2)*pow(y0, 2))))/(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) + pow(b, 2)*pow(c, 2)) + y0;</pre>
<pre>z = l*(-pow(a, 2)*pow(b, 2)*l*z0 - pow(a, 2)*pow(c, 2)*k*y0 - pow(b, 2)*pow(c, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*pow(c, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) - pow(a, 2)*pow(k, 2)*pow(z0, 2) + 2*pow(a, 2)*k*l*y0*z0 - pow(a, 2)*pow(l, 2)*pow(y0, 2) + pow(b, 2)*pow(c, 2) - pow(b, 2)*pow(l, 2)*pow(x0, 2) + 2*pow(b, 2)*l*x0*z0 - pow(b, 2)*pow(z0, 2) - pow(c, 2)*pow(k, 2)*pow(x0, 2) + 2*pow(c, 2)*k*x0*y0 - pow(c, 2)*pow(y0, 2))))/(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) + pow(b, 2)*pow(c, 2)) + z0;</pre>
<pre>x = x0 - (pow(a, 2)*pow(b, 2)*l*z0 + pow(a, 2)*pow(c, 2)*k*y0 + pow(b, 2)*pow(c, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*pow(c, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) - pow(a, 2)*pow(k, 2)*pow(z0, 2) + 2*pow(a, 2)*k*l*y0*z0 - pow(a, 2)*pow(l, 2)*pow(y0, 2) + pow(b, 2)*pow(c, 2) - pow(b, 2)*pow(l, 2)*pow(x0, 2) + 2*pow(b, 2)*l*x0*z0 - pow(b, 2)*pow(z0, 2) - pow(c, 2)*pow(k, 2)*pow(x0, 2) + 2*pow(c, 2)*k*x0*y0 - pow(c, 2)*pow(y0, 2))))/(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) + pow(b, 2)*pow(c, 2));</pre>
<pre>y = -k*(pow(a, 2)*pow(b, 2)*l*z0 + pow(a, 2)*pow(c, 2)*k*y0 + pow(b, 2)*pow(c, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*pow(c, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) - pow(a, 2)*pow(k, 2)*pow(z0, 2) + 2*pow(a, 2)*k*l*y0*z0 - pow(a, 2)*pow(l, 2)*pow(y0, 2) + pow(b, 2)*pow(c, 2) - pow(b, 2)*pow(l, 2)*pow(x0, 2) + 2*pow(b, 2)*l*x0*z0 - pow(b, 2)*pow(z0, 2) - pow(c, 2)*pow(k, 2)*pow(x0, 2) + 2*pow(c, 2)*k*x0*y0 - pow(c, 2)*pow(y0, 2))))/(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) + pow(b, 2)*pow(c, 2)) + y0;</pre>
<pre>z = -l*(pow(a, 2)*pow(b, 2)*l*z0 + pow(a, 2)*pow(c, 2)*k*y0 + pow(b, 2)*pow(c, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*pow(c, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) - pow(a, 2)*pow(k, 2)*pow(z0, 2) + 2*pow(a, 2)*k*l*y0*z0 - pow(a, 2)*pow(l, 2)*pow(y0, 2) + pow(b, 2)*pow(c, 2) - pow(b, 2)*pow(l, 2)*pow(x0, 2) + 2*pow(b, 2)*l*x0*z0 - pow(b, 2)*pow(z0, 2) - pow(c, 2)*pow(k, 2)*pow(x0, 2) + 2*pow(c, 2)*k*x0*y0 - pow(c, 2)*pow(y0, 2))))/(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) + pow(b, 2)*pow(c, 2)) + z0;</pre>
<h4>Distance inside</h4>
<p>Distance between crossing points.</p>
<img src="eq199.png" alt="2 \left\lvert{\frac{1}{a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} + b^{2} c^{2}} \sqrt{a^{2} b^{2} c^{2} \left(a^{2} b^{2} l^{2} + a^{2} c^{2} k^{2} - a^{2} k^{2} z_{0}^{2} + 2 a^{2} k l y_{0} z_{0} - a^{2} l^{2} y_{0}^{2} + b^{2} c^{2} - b^{2} l^{2} x_{0}^{2} + 2 b^{2} l x_{0} z_{0} - b^{2} z_{0}^{2} - c^{2} k^{2} x_{0}^{2} + 2 c^{2} k x_{0} y_{0} - c^{2} y_{0}^{2}\right)}}\right\rvert" />
<h4>C Code</h4>
<pre>sol1 = (-pow(a, 2)*pow(b, 2)*l*z0 - pow(a, 2)*pow(c, 2)*k*y0 - pow(b, 2)*pow(c, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*pow(c, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) - pow(a, 2)*pow(k, 2)*pow(z0, 2) + 2*pow(a, 2)*k*l*y0*z0 - pow(a, 2)*pow(l, 2)*pow(y0, 2) + pow(b, 2)*pow(c, 2) - pow(b, 2)*pow(l, 2)*pow(x0, 2) + 2*pow(b, 2)*l*x0*z0 - pow(b, 2)*pow(z0, 2) - pow(c, 2)*pow(k, 2)*pow(x0, 2) + 2*pow(c, 2)*k*x0*y0 - pow(c, 2)*pow(y0, 2))))/(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) + pow(b, 2)*pow(c, 2));</pre><pre>sol2 = -(pow(a, 2)*pow(b, 2)*l*z0 + pow(a, 2)*pow(c, 2)*k*y0 + pow(b, 2)*pow(c, 2)*x0 + sqrt(pow(a, 2)*pow(b, 2)*pow(c, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) - pow(a, 2)*pow(k, 2)*pow(z0, 2) + 2*pow(a, 2)*k*l*y0*z0 - pow(a, 2)*pow(l, 2)*pow(y0, 2) + pow(b, 2)*pow(c, 2) - pow(b, 2)*pow(l, 2)*pow(x0, 2) + 2*pow(b, 2)*l*x0*z0 - pow(b, 2)*pow(z0, 2) - pow(c, 2)*pow(k, 2)*pow(x0, 2) + 2*pow(c, 2)*k*x0*y0 - pow(c, 2)*pow(y0, 2))))/(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) + pow(b, 2)*pow(c, 2));</pre><pre>distance = 2*fabs(sqrt(pow(a, 2)*pow(b, 2)*pow(c, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) - pow(a, 2)*pow(k, 2)*pow(z0, 2) + 2*pow(a, 2)*k*l*y0*z0 - pow(a, 2)*pow(l, 2)*pow(y0, 2) + pow(b, 2)*pow(c, 2) - pow(b, 2)*pow(l, 2)*pow(x0, 2) + 2*pow(b, 2)*l*x0*z0 - pow(b, 2)*pow(z0, 2) - pow(c, 2)*pow(k, 2)*pow(x0, 2) + 2*pow(c, 2)*k*x0*y0 - pow(c, 2)*pow(y0, 2)))/(pow(a, 2)*pow(b, 2)*pow(l, 2) + pow(a, 2)*pow(c, 2)*pow(k, 2) + pow(b, 2)*pow(c, 2)));</pre><hr/>
<h4>Equation for line (spherical)</h4>
<ul>
<li>x: <img src="eq200.png" alt="t \sin{\left (\theta \right )} \cos{\left (\phi \right )} + x_{0}" /></li>
<li>y: <img src="eq201.png" alt="t \sin{\left (\phi \right )} \sin{\left (\theta \right )} + y_{0}" /></li>
<li>z: <img src="eq202.png" alt="t \cos{\left (\theta \right )} + z_{0}" /></li>
</ul>
<h4>Equation for ellipsoid (cartesian)</h4>
<p>Assumed to be centred at 0, the coordinate system origin.</p>
0=<img src="eq203.png" alt="-1 + \frac{z^{2}}{c^{2}} + \frac{y^{2}}{b^{2}} + \frac{x^{2}}{a^{2}}" />
<h4>Intersection solutions</h4>
<p>Parametric solution (t). Solutions were derived automatically using sympy.</p>
<ul><li><img src="eq204.png" alt="\frac{1}{a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}} \left(- a^{2} b^{2} z_{0} \cos{\left (\theta \right )} - a^{2} c^{2} y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} - b^{2} c^{2} x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + \sqrt{a^{2} b^{2} c^{2} \left(a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - a^{2} y_{0}^{2} \cos^{2}{\left (\theta \right )} + \frac{y_{0} z_{0}}{2} a^{2} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) - a^{2} z_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} - b^{2} x_{0}^{2} \cos^{2}{\left (\theta \right )} + \frac{x_{0} z_{0}}{2} b^{2} \left(- \sin{\left (\phi - 2 \theta \right )} + \sin{\left (\phi + 2 \theta \right )}\right) - b^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} - c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} - c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
<li><img src="eq205.png" alt="- \frac{1}{a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}} \left(a^{2} b^{2} z_{0} \cos{\left (\theta \right )} + a^{2} c^{2} y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + b^{2} c^{2} x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + \sqrt{- a^{2} b^{2} c^{2} \left(- a^{2} b^{2} \cos^{2}{\left (\theta \right )} - a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + a^{2} y_{0}^{2} \cos^{2}{\left (\theta \right )} - \frac{y_{0} z_{0}}{2} a^{2} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) + a^{2} z_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + b^{2} x_{0}^{2} \cos^{2}{\left (\theta \right )} + \frac{x_{0} z_{0}}{2} b^{2} \left(\sin{\left (\phi - 2 \theta \right )} - \sin{\left (\phi + 2 \theta \right )}\right) + b^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 2 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
</ul><p>Points in cartesian coordinates (x, y, z)</p>
<ul><li><ul><li>x: <img src="eq206.png" alt="x_{0} + \frac{\sin{\left (\theta \right )} \cos{\left (\phi \right )}}{a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}} \left(- a^{2} b^{2} z_{0} \cos{\left (\theta \right )} - a^{2} c^{2} y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} - b^{2} c^{2} x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + \sqrt{a^{2} b^{2} c^{2} \left(a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - a^{2} y_{0}^{2} \cos^{2}{\left (\theta \right )} + \frac{y_{0} z_{0}}{2} a^{2} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) - a^{2} z_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} - b^{2} x_{0}^{2} \cos^{2}{\left (\theta \right )} + \frac{x_{0} z_{0}}{2} b^{2} \left(- \sin{\left (\phi - 2 \theta \right )} + \sin{\left (\phi + 2 \theta \right )}\right) - b^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} - c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} - c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
<li>y: <img src="eq207.png" alt="y_{0} + \frac{\sin{\left (\phi \right )} \sin{\left (\theta \right )}}{a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}} \left(- a^{2} b^{2} z_{0} \cos{\left (\theta \right )} - a^{2} c^{2} y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} - b^{2} c^{2} x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + \sqrt{a^{2} b^{2} c^{2} \left(a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - a^{2} y_{0}^{2} \cos^{2}{\left (\theta \right )} + \frac{y_{0} z_{0}}{2} a^{2} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) - a^{2} z_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} - b^{2} x_{0}^{2} \cos^{2}{\left (\theta \right )} + \frac{x_{0} z_{0}}{2} b^{2} \left(- \sin{\left (\phi - 2 \theta \right )} + \sin{\left (\phi + 2 \theta \right )}\right) - b^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} - c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} - c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
<li>z: <img src="eq208.png" alt="z_{0} + \frac{\cos{\left (\theta \right )}}{a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}} \left(- a^{2} b^{2} z_{0} \cos{\left (\theta \right )} - a^{2} c^{2} y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} - b^{2} c^{2} x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + \sqrt{a^{2} b^{2} c^{2} \left(a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - a^{2} y_{0}^{2} \cos^{2}{\left (\theta \right )} + \frac{y_{0} z_{0}}{2} a^{2} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) - a^{2} z_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} - b^{2} x_{0}^{2} \cos^{2}{\left (\theta \right )} + \frac{x_{0} z_{0}}{2} b^{2} \left(- \sin{\left (\phi - 2 \theta \right )} + \sin{\left (\phi + 2 \theta \right )}\right) - b^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} - c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} - c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
</ul></li><li><ul><li>x: <img src="eq209.png" alt="x_{0} - \frac{\sin{\left (\theta \right )} \cos{\left (\phi \right )}}{a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}} \left(a^{2} b^{2} z_{0} \cos{\left (\theta \right )} + a^{2} c^{2} y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + b^{2} c^{2} x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + \sqrt{- a^{2} b^{2} c^{2} \left(- a^{2} b^{2} \cos^{2}{\left (\theta \right )} - a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + a^{2} y_{0}^{2} \cos^{2}{\left (\theta \right )} - \frac{y_{0} z_{0}}{2} a^{2} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) + a^{2} z_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + b^{2} x_{0}^{2} \cos^{2}{\left (\theta \right )} + \frac{x_{0} z_{0}}{2} b^{2} \left(\sin{\left (\phi - 2 \theta \right )} - \sin{\left (\phi + 2 \theta \right )}\right) + b^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 2 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
<li>y: <img src="eq210.png" alt="y_{0} - \frac{\sin{\left (\phi \right )} \sin{\left (\theta \right )}}{a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}} \left(a^{2} b^{2} z_{0} \cos{\left (\theta \right )} + a^{2} c^{2} y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + b^{2} c^{2} x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + \sqrt{- a^{2} b^{2} c^{2} \left(- a^{2} b^{2} \cos^{2}{\left (\theta \right )} - a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + a^{2} y_{0}^{2} \cos^{2}{\left (\theta \right )} - \frac{y_{0} z_{0}}{2} a^{2} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) + a^{2} z_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + b^{2} x_{0}^{2} \cos^{2}{\left (\theta \right )} + \frac{x_{0} z_{0}}{2} b^{2} \left(\sin{\left (\phi - 2 \theta \right )} - \sin{\left (\phi + 2 \theta \right )}\right) + b^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 2 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
<li>z: <img src="eq211.png" alt="z_{0} - \frac{\cos{\left (\theta \right )}}{a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}} \left(a^{2} b^{2} z_{0} \cos{\left (\theta \right )} + a^{2} c^{2} y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + b^{2} c^{2} x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + \sqrt{- a^{2} b^{2} c^{2} \left(- a^{2} b^{2} \cos^{2}{\left (\theta \right )} - a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + a^{2} y_{0}^{2} \cos^{2}{\left (\theta \right )} - \frac{y_{0} z_{0}}{2} a^{2} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) + a^{2} z_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + b^{2} x_{0}^{2} \cos^{2}{\left (\theta \right )} + \frac{x_{0} z_{0}}{2} b^{2} \left(\sin{\left (\phi - 2 \theta \right )} - \sin{\left (\phi + 2 \theta \right )}\right) + b^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 2 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
</ul></li></ul><h5>C Code</h5>
<pre>x = x0 + (-pow(a, 2)*pow(b, 2)*z0*cos(theta) - pow(a, 2)*pow(c, 2)*y0*sin(phi)*sin(theta) - pow(b, 2)*pow(c, 2)*x0*sin(theta)*cos(phi) + sqrt(pow(a, 2)*pow(b, 2)*pow(c, 2)*(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(a, 2)*pow(y0, 2)*pow(cos(theta), 2) + (1.0L/2.0L)*pow(a, 2)*y0*z0*(cos(phi - 2*theta) - cos(phi + 2*theta)) - pow(a, 2)*pow(z0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) - pow(b, 2)*pow(x0, 2)*pow(cos(theta), 2) + (1.0L/2.0L)*pow(b, 2)*x0*z0*(-sin(phi - 2*theta) + sin(phi + 2*theta)) - pow(b, 2)*pow(z0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) - pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) - pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))*sin(theta)*cos(phi)/(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2));</pre>
<pre>y = y0 + (-pow(a, 2)*pow(b, 2)*z0*cos(theta) - pow(a, 2)*pow(c, 2)*y0*sin(phi)*sin(theta) - pow(b, 2)*pow(c, 2)*x0*sin(theta)*cos(phi) + sqrt(pow(a, 2)*pow(b, 2)*pow(c, 2)*(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(a, 2)*pow(y0, 2)*pow(cos(theta), 2) + (1.0L/2.0L)*pow(a, 2)*y0*z0*(cos(phi - 2*theta) - cos(phi + 2*theta)) - pow(a, 2)*pow(z0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) - pow(b, 2)*pow(x0, 2)*pow(cos(theta), 2) + (1.0L/2.0L)*pow(b, 2)*x0*z0*(-sin(phi - 2*theta) + sin(phi + 2*theta)) - pow(b, 2)*pow(z0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) - pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) - pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))*sin(phi)*sin(theta)/(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2));</pre>
<pre>z = z0 + (-pow(a, 2)*pow(b, 2)*z0*cos(theta) - pow(a, 2)*pow(c, 2)*y0*sin(phi)*sin(theta) - pow(b, 2)*pow(c, 2)*x0*sin(theta)*cos(phi) + sqrt(pow(a, 2)*pow(b, 2)*pow(c, 2)*(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(a, 2)*pow(y0, 2)*pow(cos(theta), 2) + (1.0L/2.0L)*pow(a, 2)*y0*z0*(cos(phi - 2*theta) - cos(phi + 2*theta)) - pow(a, 2)*pow(z0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) - pow(b, 2)*pow(x0, 2)*pow(cos(theta), 2) + (1.0L/2.0L)*pow(b, 2)*x0*z0*(-sin(phi - 2*theta) + sin(phi + 2*theta)) - pow(b, 2)*pow(z0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) - pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) - pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))*cos(theta)/(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2));</pre>
<pre>x = x0 - (pow(a, 2)*pow(b, 2)*z0*cos(theta) + pow(a, 2)*pow(c, 2)*y0*sin(phi)*sin(theta) + pow(b, 2)*pow(c, 2)*x0*sin(theta)*cos(phi) + sqrt(-pow(a, 2)*pow(b, 2)*pow(c, 2)*(-pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) - pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(a, 2)*pow(y0, 2)*pow(cos(theta), 2) - 1.0L/2.0L*pow(a, 2)*y0*z0*(cos(phi - 2*theta) - cos(phi + 2*theta)) + pow(a, 2)*pow(z0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) + pow(b, 2)*pow(x0, 2)*pow(cos(theta), 2) + (1.0L/2.0L)*pow(b, 2)*x0*z0*(sin(phi - 2*theta) - sin(phi + 2*theta)) + pow(b, 2)*pow(z0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) + pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 2*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))*sin(theta)*cos(phi)/(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2));</pre>
<pre>y = y0 - (pow(a, 2)*pow(b, 2)*z0*cos(theta) + pow(a, 2)*pow(c, 2)*y0*sin(phi)*sin(theta) + pow(b, 2)*pow(c, 2)*x0*sin(theta)*cos(phi) + sqrt(-pow(a, 2)*pow(b, 2)*pow(c, 2)*(-pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) - pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(a, 2)*pow(y0, 2)*pow(cos(theta), 2) - 1.0L/2.0L*pow(a, 2)*y0*z0*(cos(phi - 2*theta) - cos(phi + 2*theta)) + pow(a, 2)*pow(z0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) + pow(b, 2)*pow(x0, 2)*pow(cos(theta), 2) + (1.0L/2.0L)*pow(b, 2)*x0*z0*(sin(phi - 2*theta) - sin(phi + 2*theta)) + pow(b, 2)*pow(z0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) + pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 2*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))*sin(phi)*sin(theta)/(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2));</pre>
<pre>z = z0 - (pow(a, 2)*pow(b, 2)*z0*cos(theta) + pow(a, 2)*pow(c, 2)*y0*sin(phi)*sin(theta) + pow(b, 2)*pow(c, 2)*x0*sin(theta)*cos(phi) + sqrt(-pow(a, 2)*pow(b, 2)*pow(c, 2)*(-pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) - pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(a, 2)*pow(y0, 2)*pow(cos(theta), 2) - 1.0L/2.0L*pow(a, 2)*y0*z0*(cos(phi - 2*theta) - cos(phi + 2*theta)) + pow(a, 2)*pow(z0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) + pow(b, 2)*pow(x0, 2)*pow(cos(theta), 2) + (1.0L/2.0L)*pow(b, 2)*x0*z0*(sin(phi - 2*theta) - sin(phi + 2*theta)) + pow(b, 2)*pow(z0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) + pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 2*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))*cos(theta)/(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2));</pre>
<h4>Distance inside</h4>
<p>Distance between crossing points.</p>
<img src="eq212.png" alt="\sqrt{2} \left\lvert{\frac{1}{a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}} \sqrt{- a^{2} b^{2} c^{2} \left(- 2 a^{2} b^{2} \cos^{2}{\left (\theta \right )} - 2 a^{2} c^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 a^{2} y_{0}^{2} \cos^{2}{\left (\theta \right )} - a^{2} y_{0} z_{0} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) + 2 a^{2} z_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 2 b^{2} c^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + 2 b^{2} x_{0}^{2} \cos^{2}{\left (\theta \right )} + b^{2} x_{0} z_{0} \left(\sin{\left (\phi - 2 \theta \right )} - \sin{\left (\phi + 2 \theta \right )}\right) + 2 b^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + 2 c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 4 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + 2 c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}}\right\rvert" />
<h4>C Code</h4>
<pre>sol1 = (-pow(a, 2)*pow(b, 2)*z0*cos(theta) - pow(a, 2)*pow(c, 2)*y0*sin(phi)*sin(theta) - pow(b, 2)*pow(c, 2)*x0*sin(theta)*cos(phi) + sqrt(pow(a, 2)*pow(b, 2)*pow(c, 2)*(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(a, 2)*pow(y0, 2)*pow(cos(theta), 2) + (1.0L/2.0L)*pow(a, 2)*y0*z0*(cos(phi - 2*theta) - cos(phi + 2*theta)) - pow(a, 2)*pow(z0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) - pow(b, 2)*pow(x0, 2)*pow(cos(theta), 2) + (1.0L/2.0L)*pow(b, 2)*x0*z0*(-sin(phi - 2*theta) + sin(phi + 2*theta)) - pow(b, 2)*pow(z0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) - pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) - pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))/(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2));</pre><pre>sol2 = -(pow(a, 2)*pow(b, 2)*z0*cos(theta) + pow(a, 2)*pow(c, 2)*y0*sin(phi)*sin(theta) + pow(b, 2)*pow(c, 2)*x0*sin(theta)*cos(phi) + sqrt(-pow(a, 2)*pow(b, 2)*pow(c, 2)*(-pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) - pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(a, 2)*pow(y0, 2)*pow(cos(theta), 2) - 1.0L/2.0L*pow(a, 2)*y0*z0*(cos(phi - 2*theta) - cos(phi + 2*theta)) + pow(a, 2)*pow(z0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) + pow(b, 2)*pow(x0, 2)*pow(cos(theta), 2) + (1.0L/2.0L)*pow(b, 2)*x0*z0*(sin(phi - 2*theta) - sin(phi + 2*theta)) + pow(b, 2)*pow(z0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) + pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 2*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))/(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2));</pre><pre>distance = sqrt(2)*fabs(sqrt(-pow(a, 2)*pow(b, 2)*pow(c, 2)*(-2*pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) - 2*pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*pow(a, 2)*pow(y0, 2)*pow(cos(theta), 2) - pow(a, 2)*y0*z0*(cos(phi - 2*theta) - cos(phi + 2*theta)) + 2*pow(a, 2)*pow(z0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 2*pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) + 2*pow(b, 2)*pow(x0, 2)*pow(cos(theta), 2) + pow(b, 2)*x0*z0*(sin(phi - 2*theta) - sin(phi + 2*theta)) + 2*pow(b, 2)*pow(z0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2) + 2*pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 4*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + 2*pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2)))/(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*pow(c, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*pow(c, 2)*pow(sin(theta), 2)*pow(cos(phi), 2)));</pre><hr/>
