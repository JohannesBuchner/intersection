<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <title>line - cone intersection -- Intersection formulas for 3d objects</title>
  </head>
  <body>
<h2>line - cone intersection</h2>
<h4>Equation for line (cartesian)</h4>
<ul>
<li>x: <img src="eq93.png" alt="t + x_{0}" /></li>
<li>y: <img src="eq94.png" alt="k t + y_{0}" /></li>
<li>z: <img src="eq95.png" alt="l t + z_{0}" /></li>
</ul>
<h4>Equation for cone (cartesian)</h4>
<p>Assumed to be centred at 0, the coordinate system origin.</p>
0=<img src="eq96.png" alt="- z^{2} + \frac{1}{c^{2}} \left(x^{2} + y^{2}\right)" />
<h4>Intersection solutions</h4>
<p>Parametric solution (t). Solutions were derived automatically using sympy.</p>
<ul><li><img src="eq97.png" alt="\frac{1}{- c^{2} l^{2} + k^{2} + 1} \left(c^{2} l z_{0} - k y_{0} - x_{0} + \sqrt{c^{2} k^{2} z_{0}^{2} - 2 c^{2} k l y_{0} z_{0} + c^{2} l^{2} x_{0}^{2} + c^{2} l^{2} y_{0}^{2} - 2 c^{2} l x_{0} z_{0} + c^{2} z_{0}^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}}\right)" /></li>
<li><img src="eq98.png" alt="\frac{1}{c^{2} l^{2} - k^{2} - 1} \left(- c^{2} l z_{0} + k y_{0} + x_{0} + \sqrt{c^{2} k^{2} z_{0}^{2} - 2 c^{2} k l y_{0} z_{0} + c^{2} l^{2} x_{0}^{2} + c^{2} l^{2} y_{0}^{2} - 2 c^{2} l x_{0} z_{0} + c^{2} z_{0}^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}}\right)" /></li>
</ul><p>Points in cartesian coordinates (x, y, z)</p>
<ul><li><ul><li>x: <img src="eq99.png" alt="x_{0} + \frac{1}{- c^{2} l^{2} + k^{2} + 1} \left(c^{2} l z_{0} - k y_{0} - x_{0} + \sqrt{c^{2} k^{2} z_{0}^{2} - 2 c^{2} k l y_{0} z_{0} + c^{2} l^{2} x_{0}^{2} + c^{2} l^{2} y_{0}^{2} - 2 c^{2} l x_{0} z_{0} + c^{2} z_{0}^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}}\right)" /></li>
<li>y: <img src="eq100.png" alt="\frac{k}{- c^{2} l^{2} + k^{2} + 1} \left(c^{2} l z_{0} - k y_{0} - x_{0} + \sqrt{c^{2} k^{2} z_{0}^{2} - 2 c^{2} k l y_{0} z_{0} + c^{2} l^{2} x_{0}^{2} + c^{2} l^{2} y_{0}^{2} - 2 c^{2} l x_{0} z_{0} + c^{2} z_{0}^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}}\right) + y_{0}" /></li>
<li>z: <img src="eq101.png" alt="\frac{l}{- c^{2} l^{2} + k^{2} + 1} \left(c^{2} l z_{0} - k y_{0} - x_{0} + \sqrt{c^{2} k^{2} z_{0}^{2} - 2 c^{2} k l y_{0} z_{0} + c^{2} l^{2} x_{0}^{2} + c^{2} l^{2} y_{0}^{2} - 2 c^{2} l x_{0} z_{0} + c^{2} z_{0}^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}}\right) + z_{0}" /></li>
</ul></li><li><ul><li>x: <img src="eq102.png" alt="x_{0} + \frac{1}{c^{2} l^{2} - k^{2} - 1} \left(- c^{2} l z_{0} + k y_{0} + x_{0} + \sqrt{c^{2} k^{2} z_{0}^{2} - 2 c^{2} k l y_{0} z_{0} + c^{2} l^{2} x_{0}^{2} + c^{2} l^{2} y_{0}^{2} - 2 c^{2} l x_{0} z_{0} + c^{2} z_{0}^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}}\right)" /></li>
<li>y: <img src="eq103.png" alt="\frac{k}{c^{2} l^{2} - k^{2} - 1} \left(- c^{2} l z_{0} + k y_{0} + x_{0} + \sqrt{c^{2} k^{2} z_{0}^{2} - 2 c^{2} k l y_{0} z_{0} + c^{2} l^{2} x_{0}^{2} + c^{2} l^{2} y_{0}^{2} - 2 c^{2} l x_{0} z_{0} + c^{2} z_{0}^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}}\right) + y_{0}" /></li>
<li>z: <img src="eq104.png" alt="\frac{l}{c^{2} l^{2} - k^{2} - 1} \left(- c^{2} l z_{0} + k y_{0} + x_{0} + \sqrt{c^{2} k^{2} z_{0}^{2} - 2 c^{2} k l y_{0} z_{0} + c^{2} l^{2} x_{0}^{2} + c^{2} l^{2} y_{0}^{2} - 2 c^{2} l x_{0} z_{0} + c^{2} z_{0}^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}}\right) + z_{0}" /></li>
</ul></li></ul><h5>C Code</h5>
<pre>x = x0 + (pow(c, 2)*l*z0 - k*y0 - x0 + sqrt(pow(c, 2)*pow(k, 2)*pow(z0, 2) - 2*pow(c, 2)*k*l*y0*z0 + pow(c, 2)*pow(l, 2)*pow(x0, 2) + pow(c, 2)*pow(l, 2)*pow(y0, 2) - 2*pow(c, 2)*l*x0*z0 + pow(c, 2)*pow(z0, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2)))/(-pow(c, 2)*pow(l, 2) + pow(k, 2) + 1);</pre>
<pre>y = k*(pow(c, 2)*l*z0 - k*y0 - x0 + sqrt(pow(c, 2)*pow(k, 2)*pow(z0, 2) - 2*pow(c, 2)*k*l*y0*z0 + pow(c, 2)*pow(l, 2)*pow(x0, 2) + pow(c, 2)*pow(l, 2)*pow(y0, 2) - 2*pow(c, 2)*l*x0*z0 + pow(c, 2)*pow(z0, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2)))/(-pow(c, 2)*pow(l, 2) + pow(k, 2) + 1) + y0;</pre>
<pre>z = l*(pow(c, 2)*l*z0 - k*y0 - x0 + sqrt(pow(c, 2)*pow(k, 2)*pow(z0, 2) - 2*pow(c, 2)*k*l*y0*z0 + pow(c, 2)*pow(l, 2)*pow(x0, 2) + pow(c, 2)*pow(l, 2)*pow(y0, 2) - 2*pow(c, 2)*l*x0*z0 + pow(c, 2)*pow(z0, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2)))/(-pow(c, 2)*pow(l, 2) + pow(k, 2) + 1) + z0;</pre>
<pre>x = x0 + (-pow(c, 2)*l*z0 + k*y0 + x0 + sqrt(pow(c, 2)*pow(k, 2)*pow(z0, 2) - 2*pow(c, 2)*k*l*y0*z0 + pow(c, 2)*pow(l, 2)*pow(x0, 2) + pow(c, 2)*pow(l, 2)*pow(y0, 2) - 2*pow(c, 2)*l*x0*z0 + pow(c, 2)*pow(z0, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2)))/(pow(c, 2)*pow(l, 2) - pow(k, 2) - 1);</pre>
<pre>y = k*(-pow(c, 2)*l*z0 + k*y0 + x0 + sqrt(pow(c, 2)*pow(k, 2)*pow(z0, 2) - 2*pow(c, 2)*k*l*y0*z0 + pow(c, 2)*pow(l, 2)*pow(x0, 2) + pow(c, 2)*pow(l, 2)*pow(y0, 2) - 2*pow(c, 2)*l*x0*z0 + pow(c, 2)*pow(z0, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2)))/(pow(c, 2)*pow(l, 2) - pow(k, 2) - 1) + y0;</pre>
<pre>z = l*(-pow(c, 2)*l*z0 + k*y0 + x0 + sqrt(pow(c, 2)*pow(k, 2)*pow(z0, 2) - 2*pow(c, 2)*k*l*y0*z0 + pow(c, 2)*pow(l, 2)*pow(x0, 2) + pow(c, 2)*pow(l, 2)*pow(y0, 2) - 2*pow(c, 2)*l*x0*z0 + pow(c, 2)*pow(z0, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2)))/(pow(c, 2)*pow(l, 2) - pow(k, 2) - 1) + z0;</pre>
<h4>Distance inside</h4>
<p>Distance between crossing points.</p>
<img src="eq105.png" alt="2 \left\lvert{\frac{1}{- c^{2} l^{2} + k^{2} + 1} \sqrt{c^{2} k^{2} z_{0}^{2} - 2 c^{2} k l y_{0} z_{0} + c^{2} l^{2} x_{0}^{2} + c^{2} l^{2} y_{0}^{2} - 2 c^{2} l x_{0} z_{0} + c^{2} z_{0}^{2} - k^{2} x_{0}^{2} + 2 k x_{0} y_{0} - y_{0}^{2}}}\right\rvert" />
<h4>C Code</h4>
<pre>sol1 = (pow(c, 2)*l*z0 - k*y0 - x0 + sqrt(pow(c, 2)*pow(k, 2)*pow(z0, 2) - 2*pow(c, 2)*k*l*y0*z0 + pow(c, 2)*pow(l, 2)*pow(x0, 2) + pow(c, 2)*pow(l, 2)*pow(y0, 2) - 2*pow(c, 2)*l*x0*z0 + pow(c, 2)*pow(z0, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2)))/(-pow(c, 2)*pow(l, 2) + pow(k, 2) + 1);</pre><pre>sol2 = (-pow(c, 2)*l*z0 + k*y0 + x0 + sqrt(pow(c, 2)*pow(k, 2)*pow(z0, 2) - 2*pow(c, 2)*k*l*y0*z0 + pow(c, 2)*pow(l, 2)*pow(x0, 2) + pow(c, 2)*pow(l, 2)*pow(y0, 2) - 2*pow(c, 2)*l*x0*z0 + pow(c, 2)*pow(z0, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2)))/(pow(c, 2)*pow(l, 2) - pow(k, 2) - 1);</pre><pre>distance = 2*fabs(sqrt(pow(c, 2)*pow(k, 2)*pow(z0, 2) - 2*pow(c, 2)*k*l*y0*z0 + pow(c, 2)*pow(l, 2)*pow(x0, 2) + pow(c, 2)*pow(l, 2)*pow(y0, 2) - 2*pow(c, 2)*l*x0*z0 + pow(c, 2)*pow(z0, 2) - pow(k, 2)*pow(x0, 2) + 2*k*x0*y0 - pow(y0, 2))/(-pow(c, 2)*pow(l, 2) + pow(k, 2) + 1));</pre><hr/>
<h4>Equation for line (spherical)</h4>
<ul>
<li>x: <img src="eq106.png" alt="t \sin{\left (\theta \right )} \cos{\left (\phi \right )} + x_{0}" /></li>
<li>y: <img src="eq107.png" alt="t \sin{\left (\phi \right )} \sin{\left (\theta \right )} + y_{0}" /></li>
<li>z: <img src="eq108.png" alt="t \cos{\left (\theta \right )} + z_{0}" /></li>
</ul>
<h4>Equation for cone (cartesian)</h4>
<p>Assumed to be centred at 0, the coordinate system origin.</p>
0=<img src="eq109.png" alt="- z^{2} + \frac{1}{c^{2}} \left(x^{2} + y^{2}\right)" />
<h4>Intersection solutions</h4>
<p>Parametric solution (t). Solutions were derived automatically using sympy.</p>
<ul><li><img src="eq110.png" alt="\frac{1}{- c^{2} \cos^{2}{\left (\theta \right )} - \cos^{2}{\left (\theta \right )} + 1} \left(c^{2} z_{0} \cos{\left (\theta \right )} - x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} - y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + \sqrt{- c^{2} x_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} x_{0}^{2} - 2 c^{2} x_{0} z_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} \cos{\left (\theta \right )} - c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} y_{0}^{2} - 2 c^{2} y_{0} z_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} \cos{\left (\theta \right )} + c^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + y_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - y_{0}^{2} \sin^{2}{\left (\theta \right )}}\right)" /></li>
<li><img src="eq111.png" alt="\frac{1}{c^{2} \cos^{2}{\left (\theta \right )} + \cos^{2}{\left (\theta \right )} - 1} \left(- c^{2} z_{0} \cos{\left (\theta \right )} + x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + \sqrt{- c^{2} x_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} x_{0}^{2} - 2 c^{2} x_{0} z_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} \cos{\left (\theta \right )} - c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} y_{0}^{2} - 2 c^{2} y_{0} z_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} \cos{\left (\theta \right )} + c^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + y_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - y_{0}^{2} \sin^{2}{\left (\theta \right )}}\right)" /></li>
</ul><p>Points in cartesian coordinates (x, y, z)</p>
<ul><li><ul><li>x: <img src="eq112.png" alt="x_{0} + \frac{\sin{\left (\theta \right )} \cos{\left (\phi \right )}}{- c^{2} \cos^{2}{\left (\theta \right )} - \cos^{2}{\left (\theta \right )} + 1} \left(c^{2} z_{0} \cos{\left (\theta \right )} - x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} - y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + \sqrt{- c^{2} x_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} x_{0}^{2} - 2 c^{2} x_{0} z_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} \cos{\left (\theta \right )} - c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} y_{0}^{2} - 2 c^{2} y_{0} z_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} \cos{\left (\theta \right )} + c^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + y_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - y_{0}^{2} \sin^{2}{\left (\theta \right )}}\right)" /></li>
<li>y: <img src="eq113.png" alt="y_{0} + \frac{\sin{\left (\phi \right )} \sin{\left (\theta \right )}}{- c^{2} \cos^{2}{\left (\theta \right )} - \cos^{2}{\left (\theta \right )} + 1} \left(c^{2} z_{0} \cos{\left (\theta \right )} - x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} - y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + \sqrt{- c^{2} x_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} x_{0}^{2} - 2 c^{2} x_{0} z_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} \cos{\left (\theta \right )} - c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} y_{0}^{2} - 2 c^{2} y_{0} z_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} \cos{\left (\theta \right )} + c^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + y_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - y_{0}^{2} \sin^{2}{\left (\theta \right )}}\right)" /></li>
<li>z: <img src="eq114.png" alt="z_{0} + \frac{\cos{\left (\theta \right )}}{- c^{2} \cos^{2}{\left (\theta \right )} - \cos^{2}{\left (\theta \right )} + 1} \left(c^{2} z_{0} \cos{\left (\theta \right )} - x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} - y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + \sqrt{- c^{2} x_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} x_{0}^{2} - 2 c^{2} x_{0} z_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} \cos{\left (\theta \right )} - c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} y_{0}^{2} - 2 c^{2} y_{0} z_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} \cos{\left (\theta \right )} + c^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + y_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - y_{0}^{2} \sin^{2}{\left (\theta \right )}}\right)" /></li>
</ul></li><li><ul><li>x: <img src="eq115.png" alt="x_{0} + \frac{\sin{\left (\theta \right )} \cos{\left (\phi \right )}}{c^{2} \cos^{2}{\left (\theta \right )} + \cos^{2}{\left (\theta \right )} - 1} \left(- c^{2} z_{0} \cos{\left (\theta \right )} + x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + \sqrt{- c^{2} x_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} x_{0}^{2} - 2 c^{2} x_{0} z_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} \cos{\left (\theta \right )} - c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} y_{0}^{2} - 2 c^{2} y_{0} z_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} \cos{\left (\theta \right )} + c^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + y_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - y_{0}^{2} \sin^{2}{\left (\theta \right )}}\right)" /></li>
<li>y: <img src="eq116.png" alt="y_{0} + \frac{\sin{\left (\phi \right )} \sin{\left (\theta \right )}}{c^{2} \cos^{2}{\left (\theta \right )} + \cos^{2}{\left (\theta \right )} - 1} \left(- c^{2} z_{0} \cos{\left (\theta \right )} + x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + \sqrt{- c^{2} x_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} x_{0}^{2} - 2 c^{2} x_{0} z_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} \cos{\left (\theta \right )} - c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} y_{0}^{2} - 2 c^{2} y_{0} z_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} \cos{\left (\theta \right )} + c^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + y_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - y_{0}^{2} \sin^{2}{\left (\theta \right )}}\right)" /></li>
<li>z: <img src="eq117.png" alt="z_{0} + \frac{\cos{\left (\theta \right )}}{c^{2} \cos^{2}{\left (\theta \right )} + \cos^{2}{\left (\theta \right )} - 1} \left(- c^{2} z_{0} \cos{\left (\theta \right )} + x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + \sqrt{- c^{2} x_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} x_{0}^{2} - 2 c^{2} x_{0} z_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} \cos{\left (\theta \right )} - c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} y_{0}^{2} - 2 c^{2} y_{0} z_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} \cos{\left (\theta \right )} + c^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + y_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - y_{0}^{2} \sin^{2}{\left (\theta \right )}}\right)" /></li>
</ul></li></ul><h5>C Code</h5>
<pre>x = x0 + (pow(c, 2)*z0*cos(theta) - x0*sin(theta)*cos(phi) - y0*sin(phi)*sin(theta) + sqrt(-pow(c, 2)*pow(x0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(x0, 2) - 2*pow(c, 2)*x0*z0*sin(theta)*cos(phi)*cos(theta) - pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(y0, 2) - 2*pow(c, 2)*y0*z0*sin(phi)*sin(theta)*cos(theta) + pow(c, 2)*pow(z0, 2)*pow(sin(theta), 2) - pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + pow(y0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(y0, 2)*pow(sin(theta), 2)))*sin(theta)*cos(phi)/(-pow(c, 2)*pow(cos(theta), 2) - pow(cos(theta), 2) + 1);</pre>
<pre>y = y0 + (pow(c, 2)*z0*cos(theta) - x0*sin(theta)*cos(phi) - y0*sin(phi)*sin(theta) + sqrt(-pow(c, 2)*pow(x0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(x0, 2) - 2*pow(c, 2)*x0*z0*sin(theta)*cos(phi)*cos(theta) - pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(y0, 2) - 2*pow(c, 2)*y0*z0*sin(phi)*sin(theta)*cos(theta) + pow(c, 2)*pow(z0, 2)*pow(sin(theta), 2) - pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + pow(y0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(y0, 2)*pow(sin(theta), 2)))*sin(phi)*sin(theta)/(-pow(c, 2)*pow(cos(theta), 2) - pow(cos(theta), 2) + 1);</pre>
<pre>z = z0 + (pow(c, 2)*z0*cos(theta) - x0*sin(theta)*cos(phi) - y0*sin(phi)*sin(theta) + sqrt(-pow(c, 2)*pow(x0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(x0, 2) - 2*pow(c, 2)*x0*z0*sin(theta)*cos(phi)*cos(theta) - pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(y0, 2) - 2*pow(c, 2)*y0*z0*sin(phi)*sin(theta)*cos(theta) + pow(c, 2)*pow(z0, 2)*pow(sin(theta), 2) - pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + pow(y0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(y0, 2)*pow(sin(theta), 2)))*cos(theta)/(-pow(c, 2)*pow(cos(theta), 2) - pow(cos(theta), 2) + 1);</pre>
<pre>x = x0 + (-pow(c, 2)*z0*cos(theta) + x0*sin(theta)*cos(phi) + y0*sin(phi)*sin(theta) + sqrt(-pow(c, 2)*pow(x0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(x0, 2) - 2*pow(c, 2)*x0*z0*sin(theta)*cos(phi)*cos(theta) - pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(y0, 2) - 2*pow(c, 2)*y0*z0*sin(phi)*sin(theta)*cos(theta) + pow(c, 2)*pow(z0, 2)*pow(sin(theta), 2) - pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + pow(y0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(y0, 2)*pow(sin(theta), 2)))*sin(theta)*cos(phi)/(pow(c, 2)*pow(cos(theta), 2) + pow(cos(theta), 2) - 1);</pre>
<pre>y = y0 + (-pow(c, 2)*z0*cos(theta) + x0*sin(theta)*cos(phi) + y0*sin(phi)*sin(theta) + sqrt(-pow(c, 2)*pow(x0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(x0, 2) - 2*pow(c, 2)*x0*z0*sin(theta)*cos(phi)*cos(theta) - pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(y0, 2) - 2*pow(c, 2)*y0*z0*sin(phi)*sin(theta)*cos(theta) + pow(c, 2)*pow(z0, 2)*pow(sin(theta), 2) - pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + pow(y0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(y0, 2)*pow(sin(theta), 2)))*sin(phi)*sin(theta)/(pow(c, 2)*pow(cos(theta), 2) + pow(cos(theta), 2) - 1);</pre>
<pre>z = z0 + (-pow(c, 2)*z0*cos(theta) + x0*sin(theta)*cos(phi) + y0*sin(phi)*sin(theta) + sqrt(-pow(c, 2)*pow(x0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(x0, 2) - 2*pow(c, 2)*x0*z0*sin(theta)*cos(phi)*cos(theta) - pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(y0, 2) - 2*pow(c, 2)*y0*z0*sin(phi)*sin(theta)*cos(theta) + pow(c, 2)*pow(z0, 2)*pow(sin(theta), 2) - pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + pow(y0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(y0, 2)*pow(sin(theta), 2)))*cos(theta)/(pow(c, 2)*pow(cos(theta), 2) + pow(cos(theta), 2) - 1);</pre>
<h4>Distance inside</h4>
<p>Distance between crossing points.</p>
<img src="eq118.png" alt="2 \left\lvert{\frac{1}{c^{2} \cos^{2}{\left (\theta \right )} + \cos^{2}{\left (\theta \right )} - 1} \sqrt{- c^{2} x_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} x_{0}^{2} - \frac{x_{0} z_{0}}{2} c^{2} \left(- \sin{\left (\phi - 2 \theta \right )} + \sin{\left (\phi + 2 \theta \right )}\right) - c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} + c^{2} y_{0}^{2} - \frac{y_{0} z_{0}}{2} c^{2} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) + c^{2} z_{0}^{2} \sin^{2}{\left (\theta \right )} - x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + 2 x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + y_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - y_{0}^{2} \sin^{2}{\left (\theta \right )}}}\right\rvert" />
<h4>C Code</h4>
<pre>sol1 = (pow(c, 2)*z0*cos(theta) - x0*sin(theta)*cos(phi) - y0*sin(phi)*sin(theta) + sqrt(-pow(c, 2)*pow(x0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(x0, 2) - 2*pow(c, 2)*x0*z0*sin(theta)*cos(phi)*cos(theta) - pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(y0, 2) - 2*pow(c, 2)*y0*z0*sin(phi)*sin(theta)*cos(theta) + pow(c, 2)*pow(z0, 2)*pow(sin(theta), 2) - pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + pow(y0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(y0, 2)*pow(sin(theta), 2)))/(-pow(c, 2)*pow(cos(theta), 2) - pow(cos(theta), 2) + 1);</pre><pre>sol2 = (-pow(c, 2)*z0*cos(theta) + x0*sin(theta)*cos(phi) + y0*sin(phi)*sin(theta) + sqrt(-pow(c, 2)*pow(x0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(x0, 2) - 2*pow(c, 2)*x0*z0*sin(theta)*cos(phi)*cos(theta) - pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(y0, 2) - 2*pow(c, 2)*y0*z0*sin(phi)*sin(theta)*cos(theta) + pow(c, 2)*pow(z0, 2)*pow(sin(theta), 2) - pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + pow(y0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(y0, 2)*pow(sin(theta), 2)))/(pow(c, 2)*pow(cos(theta), 2) + pow(cos(theta), 2) - 1);</pre><pre>distance = 2*fabs(sqrt(-pow(c, 2)*pow(x0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(x0, 2) - 1.0L/2.0L*pow(c, 2)*x0*z0*(-sin(phi - 2*theta) + sin(phi + 2*theta)) - pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2) + pow(c, 2)*pow(y0, 2) - 1.0L/2.0L*pow(c, 2)*y0*z0*(cos(phi - 2*theta) - cos(phi + 2*theta)) + pow(c, 2)*pow(z0, 2)*pow(sin(theta), 2) - pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) + 2*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + pow(y0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(y0, 2)*pow(sin(theta), 2))/(pow(c, 2)*pow(cos(theta), 2) + pow(cos(theta), 2) - 1));</pre><hr/>
