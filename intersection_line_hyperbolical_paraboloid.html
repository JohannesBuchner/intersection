<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <title>line - hyperbolical_paraboloid intersection -- Intersection formulas for 3d objects</title>
  </head>
  <body>
<h2>line - hyperbolical_paraboloid intersection</h2>
<h4>Equation for line (cartesian)</h4>
<ul>
<li>x: <img src="eq41.png" alt="t + x_{0}" /></li>
<li>y: <img src="eq42.png" alt="k t + y_{0}" /></li>
<li>z: <img src="eq43.png" alt="l t + z_{0}" /></li>
</ul>
<h4>Equation for hyperbolical_paraboloid (cartesian)</h4>
<p>Assumed to be centred at 0, the coordinate system origin.</p>
0=<img src="eq44.png" alt="- \frac{z}{c} - \frac{y^{2}}{b^{2}} + \frac{x^{2}}{a^{2}}" />
<h4>Intersection solutions</h4>
<p>Parametric solution (t). Solutions were derived automatically using sympy.</p>
<ul><li><img src="eq45.png" alt="\frac{1}{c \left(a^{2} k^{2} - b^{2}\right)} \left(- \frac{a^{2} l}{2} b^{2} - a^{2} c k y_{0} + b^{2} c x_{0} - \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} l^{2} - 4 a^{2} c k^{2} z_{0} + 4 a^{2} c k l y_{0} - 4 b^{2} c l x_{0} + 4 b^{2} c z_{0} + 4 c^{2} k^{2} x_{0}^{2} - 8 c^{2} k x_{0} y_{0} + 4 c^{2} y_{0}^{2}\right)}\right)" /></li>
<li><img src="eq46.png" alt="\frac{1}{c \left(a^{2} k^{2} - b^{2}\right)} \left(- \frac{a^{2} l}{2} b^{2} - a^{2} c k y_{0} + b^{2} c x_{0} + \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} l^{2} - 4 a^{2} c k^{2} z_{0} + 4 a^{2} c k l y_{0} - 4 b^{2} c l x_{0} + 4 b^{2} c z_{0} + 4 c^{2} k^{2} x_{0}^{2} - 8 c^{2} k x_{0} y_{0} + 4 c^{2} y_{0}^{2}\right)}\right)" /></li>
</ul><p>Points in cartesian coordinates (x, y, z)</p>
<ul><li><ul><li>x: <img src="eq47.png" alt="x_{0} + \frac{1}{c \left(a^{2} k^{2} - b^{2}\right)} \left(- \frac{a^{2} l}{2} b^{2} - a^{2} c k y_{0} + b^{2} c x_{0} - \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} l^{2} - 4 a^{2} c k^{2} z_{0} + 4 a^{2} c k l y_{0} - 4 b^{2} c l x_{0} + 4 b^{2} c z_{0} + 4 c^{2} k^{2} x_{0}^{2} - 8 c^{2} k x_{0} y_{0} + 4 c^{2} y_{0}^{2}\right)}\right)" /></li>
<li>y: <img src="eq48.png" alt="y_{0} + \frac{k}{c \left(a^{2} k^{2} - b^{2}\right)} \left(- \frac{a^{2} l}{2} b^{2} - a^{2} c k y_{0} + b^{2} c x_{0} - \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} l^{2} - 4 a^{2} c k^{2} z_{0} + 4 a^{2} c k l y_{0} - 4 b^{2} c l x_{0} + 4 b^{2} c z_{0} + 4 c^{2} k^{2} x_{0}^{2} - 8 c^{2} k x_{0} y_{0} + 4 c^{2} y_{0}^{2}\right)}\right)" /></li>
<li>z: <img src="eq49.png" alt="z_{0} + \frac{l}{c \left(a^{2} k^{2} - b^{2}\right)} \left(- \frac{a^{2} l}{2} b^{2} - a^{2} c k y_{0} + b^{2} c x_{0} - \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} l^{2} - 4 a^{2} c k^{2} z_{0} + 4 a^{2} c k l y_{0} - 4 b^{2} c l x_{0} + 4 b^{2} c z_{0} + 4 c^{2} k^{2} x_{0}^{2} - 8 c^{2} k x_{0} y_{0} + 4 c^{2} y_{0}^{2}\right)}\right)" /></li>
</ul></li><li><ul><li>x: <img src="eq50.png" alt="x_{0} + \frac{1}{c \left(a^{2} k^{2} - b^{2}\right)} \left(- \frac{a^{2} l}{2} b^{2} - a^{2} c k y_{0} + b^{2} c x_{0} + \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} l^{2} - 4 a^{2} c k^{2} z_{0} + 4 a^{2} c k l y_{0} - 4 b^{2} c l x_{0} + 4 b^{2} c z_{0} + 4 c^{2} k^{2} x_{0}^{2} - 8 c^{2} k x_{0} y_{0} + 4 c^{2} y_{0}^{2}\right)}\right)" /></li>
<li>y: <img src="eq51.png" alt="y_{0} + \frac{k}{c \left(a^{2} k^{2} - b^{2}\right)} \left(- \frac{a^{2} l}{2} b^{2} - a^{2} c k y_{0} + b^{2} c x_{0} + \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} l^{2} - 4 a^{2} c k^{2} z_{0} + 4 a^{2} c k l y_{0} - 4 b^{2} c l x_{0} + 4 b^{2} c z_{0} + 4 c^{2} k^{2} x_{0}^{2} - 8 c^{2} k x_{0} y_{0} + 4 c^{2} y_{0}^{2}\right)}\right)" /></li>
<li>z: <img src="eq52.png" alt="z_{0} + \frac{l}{c \left(a^{2} k^{2} - b^{2}\right)} \left(- \frac{a^{2} l}{2} b^{2} - a^{2} c k y_{0} + b^{2} c x_{0} + \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} l^{2} - 4 a^{2} c k^{2} z_{0} + 4 a^{2} c k l y_{0} - 4 b^{2} c l x_{0} + 4 b^{2} c z_{0} + 4 c^{2} k^{2} x_{0}^{2} - 8 c^{2} k x_{0} y_{0} + 4 c^{2} y_{0}^{2}\right)}\right)" /></li>
</ul></li></ul><h5>C Code</h5>
<pre>x = x0 + (-1.0L/2.0L*pow(a, 2)*pow(b, 2)*l - pow(a, 2)*c*k*y0 + pow(b, 2)*c*x0 - 1.0L/2.0L*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) - 4*pow(a, 2)*c*pow(k, 2)*z0 + 4*pow(a, 2)*c*k*l*y0 - 4*pow(b, 2)*c*l*x0 + 4*pow(b, 2)*c*z0 + 4*pow(c, 2)*pow(k, 2)*pow(x0, 2) - 8*pow(c, 2)*k*x0*y0 + 4*pow(c, 2)*pow(y0, 2))))/(c*(pow(a, 2)*pow(k, 2) - pow(b, 2)));</pre>
<pre>y = y0 + k*(-1.0L/2.0L*pow(a, 2)*pow(b, 2)*l - pow(a, 2)*c*k*y0 + pow(b, 2)*c*x0 - 1.0L/2.0L*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) - 4*pow(a, 2)*c*pow(k, 2)*z0 + 4*pow(a, 2)*c*k*l*y0 - 4*pow(b, 2)*c*l*x0 + 4*pow(b, 2)*c*z0 + 4*pow(c, 2)*pow(k, 2)*pow(x0, 2) - 8*pow(c, 2)*k*x0*y0 + 4*pow(c, 2)*pow(y0, 2))))/(c*(pow(a, 2)*pow(k, 2) - pow(b, 2)));</pre>
<pre>z = z0 + l*(-1.0L/2.0L*pow(a, 2)*pow(b, 2)*l - pow(a, 2)*c*k*y0 + pow(b, 2)*c*x0 - 1.0L/2.0L*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) - 4*pow(a, 2)*c*pow(k, 2)*z0 + 4*pow(a, 2)*c*k*l*y0 - 4*pow(b, 2)*c*l*x0 + 4*pow(b, 2)*c*z0 + 4*pow(c, 2)*pow(k, 2)*pow(x0, 2) - 8*pow(c, 2)*k*x0*y0 + 4*pow(c, 2)*pow(y0, 2))))/(c*(pow(a, 2)*pow(k, 2) - pow(b, 2)));</pre>
<pre>x = x0 + (-1.0L/2.0L*pow(a, 2)*pow(b, 2)*l - pow(a, 2)*c*k*y0 + pow(b, 2)*c*x0 + (1.0L/2.0L)*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) - 4*pow(a, 2)*c*pow(k, 2)*z0 + 4*pow(a, 2)*c*k*l*y0 - 4*pow(b, 2)*c*l*x0 + 4*pow(b, 2)*c*z0 + 4*pow(c, 2)*pow(k, 2)*pow(x0, 2) - 8*pow(c, 2)*k*x0*y0 + 4*pow(c, 2)*pow(y0, 2))))/(c*(pow(a, 2)*pow(k, 2) - pow(b, 2)));</pre>
<pre>y = y0 + k*(-1.0L/2.0L*pow(a, 2)*pow(b, 2)*l - pow(a, 2)*c*k*y0 + pow(b, 2)*c*x0 + (1.0L/2.0L)*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) - 4*pow(a, 2)*c*pow(k, 2)*z0 + 4*pow(a, 2)*c*k*l*y0 - 4*pow(b, 2)*c*l*x0 + 4*pow(b, 2)*c*z0 + 4*pow(c, 2)*pow(k, 2)*pow(x0, 2) - 8*pow(c, 2)*k*x0*y0 + 4*pow(c, 2)*pow(y0, 2))))/(c*(pow(a, 2)*pow(k, 2) - pow(b, 2)));</pre>
<pre>z = z0 + l*(-1.0L/2.0L*pow(a, 2)*pow(b, 2)*l - pow(a, 2)*c*k*y0 + pow(b, 2)*c*x0 + (1.0L/2.0L)*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) - 4*pow(a, 2)*c*pow(k, 2)*z0 + 4*pow(a, 2)*c*k*l*y0 - 4*pow(b, 2)*c*l*x0 + 4*pow(b, 2)*c*z0 + 4*pow(c, 2)*pow(k, 2)*pow(x0, 2) - 8*pow(c, 2)*k*x0*y0 + 4*pow(c, 2)*pow(y0, 2))))/(c*(pow(a, 2)*pow(k, 2) - pow(b, 2)));</pre>
<h4>Distance inside</h4>
<p>Distance between crossing points.</p>
<img src="eq53.png" alt="\left\lvert{\frac{1}{c \left(a^{2} k^{2} - b^{2}\right)} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} l^{2} - 4 a^{2} c k^{2} z_{0} + 4 a^{2} c k l y_{0} - 4 b^{2} c l x_{0} + 4 b^{2} c z_{0} + 4 c^{2} k^{2} x_{0}^{2} - 8 c^{2} k x_{0} y_{0} + 4 c^{2} y_{0}^{2}\right)}}\right\rvert" />
<h4>C Code</h4>
<pre>sol1 = (-1.0L/2.0L*pow(a, 2)*pow(b, 2)*l - pow(a, 2)*c*k*y0 + pow(b, 2)*c*x0 - 1.0L/2.0L*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) - 4*pow(a, 2)*c*pow(k, 2)*z0 + 4*pow(a, 2)*c*k*l*y0 - 4*pow(b, 2)*c*l*x0 + 4*pow(b, 2)*c*z0 + 4*pow(c, 2)*pow(k, 2)*pow(x0, 2) - 8*pow(c, 2)*k*x0*y0 + 4*pow(c, 2)*pow(y0, 2))))/(c*(pow(a, 2)*pow(k, 2) - pow(b, 2)));</pre><pre>sol2 = (-1.0L/2.0L*pow(a, 2)*pow(b, 2)*l - pow(a, 2)*c*k*y0 + pow(b, 2)*c*x0 + (1.0L/2.0L)*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) - 4*pow(a, 2)*c*pow(k, 2)*z0 + 4*pow(a, 2)*c*k*l*y0 - 4*pow(b, 2)*c*l*x0 + 4*pow(b, 2)*c*z0 + 4*pow(c, 2)*pow(k, 2)*pow(x0, 2) - 8*pow(c, 2)*k*x0*y0 + 4*pow(c, 2)*pow(y0, 2))))/(c*(pow(a, 2)*pow(k, 2) - pow(b, 2)));</pre><pre>distance = fabs(sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(l, 2) - 4*pow(a, 2)*c*pow(k, 2)*z0 + 4*pow(a, 2)*c*k*l*y0 - 4*pow(b, 2)*c*l*x0 + 4*pow(b, 2)*c*z0 + 4*pow(c, 2)*pow(k, 2)*pow(x0, 2) - 8*pow(c, 2)*k*x0*y0 + 4*pow(c, 2)*pow(y0, 2)))/(c*(pow(a, 2)*pow(k, 2) - pow(b, 2))));</pre><hr/>
<h4>Equation for line (spherical)</h4>
<ul>
<li>x: <img src="eq54.png" alt="t \sin{\left (\theta \right )} \cos{\left (\phi \right )} + x_{0}" /></li>
<li>y: <img src="eq55.png" alt="t \sin{\left (\phi \right )} \sin{\left (\theta \right )} + y_{0}" /></li>
<li>z: <img src="eq56.png" alt="t \cos{\left (\theta \right )} + z_{0}" /></li>
</ul>
<h4>Equation for hyperbolical_paraboloid (cartesian)</h4>
<p>Assumed to be centred at 0, the coordinate system origin.</p>
0=<img src="eq57.png" alt="- \frac{z}{c} - \frac{y^{2}}{b^{2}} + \frac{x^{2}}{a^{2}}" />
<h4>Intersection solutions</h4>
<p>Parametric solution (t). Solutions were derived automatically using sympy.</p>
<ul><li><img src="eq58.png" alt="\frac{1}{c \left(a^{2} \sin^{2}{\left (\phi \right )} - b^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} \left(- \frac{a^{2} b^{2}}{2} \cos{\left (\theta \right )} - a^{2} c y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + b^{2} c x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} - \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c y_{0} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) - 4 a^{2} c z_{0} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - b^{2} c x_{0} \left(- \sin{\left (\phi - 2 \theta \right )} + \sin{\left (\phi + 2 \theta \right )}\right) + 4 b^{2} c z_{0} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + 4 c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 8 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + 4 c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
<li><img src="eq59.png" alt="\frac{1}{c \left(a^{2} \sin^{2}{\left (\phi \right )} - b^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} \left(- \frac{a^{2} b^{2}}{2} \cos{\left (\theta \right )} - a^{2} c y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + b^{2} c x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c y_{0} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) - 4 a^{2} c z_{0} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - b^{2} c x_{0} \left(- \sin{\left (\phi - 2 \theta \right )} + \sin{\left (\phi + 2 \theta \right )}\right) + 4 b^{2} c z_{0} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + 4 c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 8 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + 4 c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
</ul><p>Points in cartesian coordinates (x, y, z)</p>
<ul><li><ul><li>x: <img src="eq60.png" alt="x_{0} + \frac{\cos{\left (\phi \right )}}{c \left(a^{2} \sin^{2}{\left (\phi \right )} - b^{2} \cos^{2}{\left (\phi \right )}\right) \sin{\left (\theta \right )}} \left(- \frac{a^{2} b^{2}}{2} \cos{\left (\theta \right )} - a^{2} c y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + b^{2} c x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} - \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c y_{0} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) - 4 a^{2} c z_{0} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - b^{2} c x_{0} \left(- \sin{\left (\phi - 2 \theta \right )} + \sin{\left (\phi + 2 \theta \right )}\right) + 4 b^{2} c z_{0} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + 4 c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 8 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + 4 c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
<li>y: <img src="eq61.png" alt="y_{0} + \frac{\sin{\left (\phi \right )}}{c \left(a^{2} \sin^{2}{\left (\phi \right )} - b^{2} \cos^{2}{\left (\phi \right )}\right) \sin{\left (\theta \right )}} \left(- \frac{a^{2} b^{2}}{2} \cos{\left (\theta \right )} - a^{2} c y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + b^{2} c x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} - \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c y_{0} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) - 4 a^{2} c z_{0} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - b^{2} c x_{0} \left(- \sin{\left (\phi - 2 \theta \right )} + \sin{\left (\phi + 2 \theta \right )}\right) + 4 b^{2} c z_{0} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + 4 c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 8 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + 4 c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
<li>z: <img src="eq62.png" alt="z_{0} + \frac{\cos{\left (\theta \right )}}{c \left(a^{2} \sin^{2}{\left (\phi \right )} - b^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} \left(- \frac{a^{2} b^{2}}{2} \cos{\left (\theta \right )} - a^{2} c y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + b^{2} c x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} - \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c y_{0} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) - 4 a^{2} c z_{0} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - b^{2} c x_{0} \left(- \sin{\left (\phi - 2 \theta \right )} + \sin{\left (\phi + 2 \theta \right )}\right) + 4 b^{2} c z_{0} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + 4 c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 8 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + 4 c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
</ul></li><li><ul><li>x: <img src="eq63.png" alt="x_{0} + \frac{\cos{\left (\phi \right )}}{c \left(a^{2} \sin^{2}{\left (\phi \right )} - b^{2} \cos^{2}{\left (\phi \right )}\right) \sin{\left (\theta \right )}} \left(- \frac{a^{2} b^{2}}{2} \cos{\left (\theta \right )} - a^{2} c y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + b^{2} c x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c y_{0} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) - 4 a^{2} c z_{0} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - b^{2} c x_{0} \left(- \sin{\left (\phi - 2 \theta \right )} + \sin{\left (\phi + 2 \theta \right )}\right) + 4 b^{2} c z_{0} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + 4 c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 8 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + 4 c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
<li>y: <img src="eq64.png" alt="y_{0} + \frac{\sin{\left (\phi \right )}}{c \left(a^{2} \sin^{2}{\left (\phi \right )} - b^{2} \cos^{2}{\left (\phi \right )}\right) \sin{\left (\theta \right )}} \left(- \frac{a^{2} b^{2}}{2} \cos{\left (\theta \right )} - a^{2} c y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + b^{2} c x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c y_{0} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) - 4 a^{2} c z_{0} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - b^{2} c x_{0} \left(- \sin{\left (\phi - 2 \theta \right )} + \sin{\left (\phi + 2 \theta \right )}\right) + 4 b^{2} c z_{0} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + 4 c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 8 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + 4 c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
<li>z: <img src="eq65.png" alt="z_{0} + \frac{\cos{\left (\theta \right )}}{c \left(a^{2} \sin^{2}{\left (\phi \right )} - b^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} \left(- \frac{a^{2} b^{2}}{2} \cos{\left (\theta \right )} - a^{2} c y_{0} \sin{\left (\phi \right )} \sin{\left (\theta \right )} + b^{2} c x_{0} \sin{\left (\theta \right )} \cos{\left (\phi \right )} + \frac{1}{2} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c y_{0} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) - 4 a^{2} c z_{0} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - b^{2} c x_{0} \left(- \sin{\left (\phi - 2 \theta \right )} + \sin{\left (\phi + 2 \theta \right )}\right) + 4 b^{2} c z_{0} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + 4 c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 8 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + 4 c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}\right)" /></li>
</ul></li></ul><h5>C Code</h5>
<pre>x = x0 + (-1.0L/2.0L*pow(a, 2)*pow(b, 2)*cos(theta) - pow(a, 2)*c*y0*sin(phi)*sin(theta) + pow(b, 2)*c*x0*sin(theta)*cos(phi) - 1.0L/2.0L*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*c*y0*(cos(phi - 2*theta) - cos(phi + 2*theta)) - 4*pow(a, 2)*c*z0*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(b, 2)*c*x0*(-sin(phi - 2*theta) + sin(phi + 2*theta)) + 4*pow(b, 2)*c*z0*pow(sin(theta), 2)*pow(cos(phi), 2) + 4*pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 8*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + 4*pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))*cos(phi)/(c*(pow(a, 2)*pow(sin(phi), 2) - pow(b, 2)*pow(cos(phi), 2))*sin(theta));</pre>
<pre>y = y0 + (-1.0L/2.0L*pow(a, 2)*pow(b, 2)*cos(theta) - pow(a, 2)*c*y0*sin(phi)*sin(theta) + pow(b, 2)*c*x0*sin(theta)*cos(phi) - 1.0L/2.0L*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*c*y0*(cos(phi - 2*theta) - cos(phi + 2*theta)) - 4*pow(a, 2)*c*z0*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(b, 2)*c*x0*(-sin(phi - 2*theta) + sin(phi + 2*theta)) + 4*pow(b, 2)*c*z0*pow(sin(theta), 2)*pow(cos(phi), 2) + 4*pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 8*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + 4*pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))*sin(phi)/(c*(pow(a, 2)*pow(sin(phi), 2) - pow(b, 2)*pow(cos(phi), 2))*sin(theta));</pre>
<pre>z = z0 + (-1.0L/2.0L*pow(a, 2)*pow(b, 2)*cos(theta) - pow(a, 2)*c*y0*sin(phi)*sin(theta) + pow(b, 2)*c*x0*sin(theta)*cos(phi) - 1.0L/2.0L*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*c*y0*(cos(phi - 2*theta) - cos(phi + 2*theta)) - 4*pow(a, 2)*c*z0*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(b, 2)*c*x0*(-sin(phi - 2*theta) + sin(phi + 2*theta)) + 4*pow(b, 2)*c*z0*pow(sin(theta), 2)*pow(cos(phi), 2) + 4*pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 8*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + 4*pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))*cos(theta)/(c*(pow(a, 2)*pow(sin(phi), 2) - pow(b, 2)*pow(cos(phi), 2))*pow(sin(theta), 2));</pre>
<pre>x = x0 + (-1.0L/2.0L*pow(a, 2)*pow(b, 2)*cos(theta) - pow(a, 2)*c*y0*sin(phi)*sin(theta) + pow(b, 2)*c*x0*sin(theta)*cos(phi) + (1.0L/2.0L)*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*c*y0*(cos(phi - 2*theta) - cos(phi + 2*theta)) - 4*pow(a, 2)*c*z0*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(b, 2)*c*x0*(-sin(phi - 2*theta) + sin(phi + 2*theta)) + 4*pow(b, 2)*c*z0*pow(sin(theta), 2)*pow(cos(phi), 2) + 4*pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 8*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + 4*pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))*cos(phi)/(c*(pow(a, 2)*pow(sin(phi), 2) - pow(b, 2)*pow(cos(phi), 2))*sin(theta));</pre>
<pre>y = y0 + (-1.0L/2.0L*pow(a, 2)*pow(b, 2)*cos(theta) - pow(a, 2)*c*y0*sin(phi)*sin(theta) + pow(b, 2)*c*x0*sin(theta)*cos(phi) + (1.0L/2.0L)*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*c*y0*(cos(phi - 2*theta) - cos(phi + 2*theta)) - 4*pow(a, 2)*c*z0*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(b, 2)*c*x0*(-sin(phi - 2*theta) + sin(phi + 2*theta)) + 4*pow(b, 2)*c*z0*pow(sin(theta), 2)*pow(cos(phi), 2) + 4*pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 8*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + 4*pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))*sin(phi)/(c*(pow(a, 2)*pow(sin(phi), 2) - pow(b, 2)*pow(cos(phi), 2))*sin(theta));</pre>
<pre>z = z0 + (-1.0L/2.0L*pow(a, 2)*pow(b, 2)*cos(theta) - pow(a, 2)*c*y0*sin(phi)*sin(theta) + pow(b, 2)*c*x0*sin(theta)*cos(phi) + (1.0L/2.0L)*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*c*y0*(cos(phi - 2*theta) - cos(phi + 2*theta)) - 4*pow(a, 2)*c*z0*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(b, 2)*c*x0*(-sin(phi - 2*theta) + sin(phi + 2*theta)) + 4*pow(b, 2)*c*z0*pow(sin(theta), 2)*pow(cos(phi), 2) + 4*pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 8*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + 4*pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))*cos(theta)/(c*(pow(a, 2)*pow(sin(phi), 2) - pow(b, 2)*pow(cos(phi), 2))*pow(sin(theta), 2));</pre>
<h4>Distance inside</h4>
<p>Distance between crossing points.</p>
<img src="eq66.png" alt="\left\lvert{\frac{1}{c \left(a^{2} \sin^{2}{\left (\phi \right )} - b^{2} \cos^{2}{\left (\phi \right )}\right) \sin^{2}{\left (\theta \right )}} \sqrt{a^{2} b^{2} \left(a^{2} b^{2} \cos^{2}{\left (\theta \right )} + a^{2} c y_{0} \left(\cos{\left (\phi - 2 \theta \right )} - \cos{\left (\phi + 2 \theta \right )}\right) - 4 a^{2} c z_{0} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} + b^{2} c x_{0} \left(\sin{\left (\phi - 2 \theta \right )} - \sin{\left (\phi + 2 \theta \right )}\right) + 4 b^{2} c z_{0} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )} + 4 c^{2} x_{0}^{2} \sin^{2}{\left (\phi \right )} \sin^{2}{\left (\theta \right )} - 8 c^{2} x_{0} y_{0} \sin{\left (\phi \right )} \sin^{2}{\left (\theta \right )} \cos{\left (\phi \right )} + 4 c^{2} y_{0}^{2} \sin^{2}{\left (\theta \right )} \cos^{2}{\left (\phi \right )}\right)}}\right\rvert" />
<h4>C Code</h4>
<pre>sol1 = (-1.0L/2.0L*pow(a, 2)*pow(b, 2)*cos(theta) - pow(a, 2)*c*y0*sin(phi)*sin(theta) + pow(b, 2)*c*x0*sin(theta)*cos(phi) - 1.0L/2.0L*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*c*y0*(cos(phi - 2*theta) - cos(phi + 2*theta)) - 4*pow(a, 2)*c*z0*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(b, 2)*c*x0*(-sin(phi - 2*theta) + sin(phi + 2*theta)) + 4*pow(b, 2)*c*z0*pow(sin(theta), 2)*pow(cos(phi), 2) + 4*pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 8*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + 4*pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))/(c*(pow(a, 2)*pow(sin(phi), 2) - pow(b, 2)*pow(cos(phi), 2))*pow(sin(theta), 2));</pre><pre>sol2 = (-1.0L/2.0L*pow(a, 2)*pow(b, 2)*cos(theta) - pow(a, 2)*c*y0*sin(phi)*sin(theta) + pow(b, 2)*c*x0*sin(theta)*cos(phi) + (1.0L/2.0L)*sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*c*y0*(cos(phi - 2*theta) - cos(phi + 2*theta)) - 4*pow(a, 2)*c*z0*pow(sin(phi), 2)*pow(sin(theta), 2) - pow(b, 2)*c*x0*(-sin(phi - 2*theta) + sin(phi + 2*theta)) + 4*pow(b, 2)*c*z0*pow(sin(theta), 2)*pow(cos(phi), 2) + 4*pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 8*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + 4*pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2))))/(c*(pow(a, 2)*pow(sin(phi), 2) - pow(b, 2)*pow(cos(phi), 2))*pow(sin(theta), 2));</pre><pre>distance = fabs(sqrt(pow(a, 2)*pow(b, 2)*(pow(a, 2)*pow(b, 2)*pow(cos(theta), 2) + pow(a, 2)*c*y0*(cos(phi - 2*theta) - cos(phi + 2*theta)) - 4*pow(a, 2)*c*z0*pow(sin(phi), 2)*pow(sin(theta), 2) + pow(b, 2)*c*x0*(sin(phi - 2*theta) - sin(phi + 2*theta)) + 4*pow(b, 2)*c*z0*pow(sin(theta), 2)*pow(cos(phi), 2) + 4*pow(c, 2)*pow(x0, 2)*pow(sin(phi), 2)*pow(sin(theta), 2) - 8*pow(c, 2)*x0*y0*sin(phi)*pow(sin(theta), 2)*cos(phi) + 4*pow(c, 2)*pow(y0, 2)*pow(sin(theta), 2)*pow(cos(phi), 2)))/(c*(pow(a, 2)*pow(sin(phi), 2) - pow(b, 2)*pow(cos(phi), 2))*pow(sin(theta), 2)));</pre><hr/>
<hr/>
<p>By Johannes Buchner | Source code: <a href="https://github.com/JohannesBuchner/intersection">https://github.com/JohannesBuchner/intersection</a> |
Open a issue or pull request if you would like somthing added</p>

